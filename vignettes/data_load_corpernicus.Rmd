---
title: "BioExtremeEvent: Dowload data from Copernicus"
author: "Victoria Delannoy, Nicolas Loiseau, Sébastien Villéger"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{BioExtremeEvent: Dowload data from Copernicus}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Aims of the function BEE.data.load_copernicus()
This is an **optional function** to import data from [Copernicus Marine Data
Store](https://data.marine.copernicus.eu/products) some dataset. This function 
uses the CopernicusMarine function in Python. To be able to run it in R a 
virtual Python environment is automaticlay created. If Python is not already on
your computer, the BEE.data.load_copernicus will download it for you. 
This allows you to copy and paste the Python API generated in the copernicus 
website (Data access>select your data and ONLY one variable> Automate> Python 
API) almost directly as argument of the BioExtremeEvent::BEE.data.load_copernicus()
function.
copernicus-sst-example.nc
# Usage 
To fullfill the argument of the BioExtremeEvent::BEE.data.load_copernicus() you
just need to copy and paste what is inside the copernicusmarine.subset funciton brakets from the Pyhton API in the BioExtremeEvent and add three arguments :
- *username*: wich is your username from the Copernicus Marine Data Store.
- *password*: your Copernicus Marine Data Store passeword.
- *output_directory*: The path where you want to store your dataset. 
```{r, eval=FALSE}
BioExtremeEvent::BEE.data.load_copernicus(
    username = my_user_name, # In addition of the API copy&paste
    password = my_password, # In addition of the API copy&paste
    dataset_id = "cmems_SST_MED_SST_L4_REP_OBSERVATIONS_010_021",
    dataset_version = "202411",
    variables = "analysed_sst", # Select only one variable ! 
    minimum_longitude = 2.9, # Use the "draw on map" option form the website 
    # to fill the GPS coordinates
    maximum_longitude = 7.8,
    minimum_latitude = 42,
    maximum_latitude = 43.7,
    start_datetime = "1982-01-01T00:00:00", # Use the 'Date range' settings
    end_datetime = "2024-12-31T00:00:00",
    coordinates_selection_method = "strict-inside",
    disable_progress_bar = TRUE,
    output_directory = here::here("Data") # In addition of the API copy&paste
)
```

You obtained a spatraster with one layer per time step. 

# Exemple of the dataset obtained


```{r}
file_name <- system.file(file.path("extdata", "copernicus-sst-example.nc"), package = "BioExtremeEvent")

copernicus_data <- terra::rast(file_name)

terra::plot(copernicus_data[[1]]) # Sea surface temperature the fisrt day of the
# dataset
```