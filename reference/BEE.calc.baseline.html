<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate baseline value for each date and pixel. — BEE.calc.baseline • BioExtremeEvent</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate baseline value for each date and pixel. — BEE.calc.baseline"><meta property="og:description" content="Calculate the daily baseline value using the mean or a quantile of a
timeserie."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioExtremeEvent</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/BioExtremeEvent.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a_load_corpernicus.html">0.1 Dowload data from Copernicus</a>
    </li>
    <li>
      <a href="../articles/b_convert_celsius.html">0.2 Convert temperature data to Celsius</a>
    </li>
    <li>
      <a href="../articles/c_calc_baseline.html">1. Compute a baseline value</a>
    </li>
    <li>
      <a href="../articles/d_calc_binarize.html">2. Compare a time serie with the baseline or fixed threshold</a>
    </li>
    <li>
      <a href="../articles/e_id_extreme_event.html">3.1 Identify extreme event according specific constraints</a>
    </li>
    <li>
      <a href="../articles/f_calc_corrections.html">3.2 Check how much corrected extreme events differ from raw extreme days.</a>
    </li>
    <li>
      <a href="../articles/g_calc_metrics_point.html">4. Calculate metrics on what is happening over time in a given pixel.</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/VicoMarbec/BioExtremeEvent/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate baseline value for each date and pixel.</h1>
    <small class="dont-index">Source: <a href="https://github.com/VicoMarbec/BioExtremeEvent/blob/main/R/bee_calc_baseline.R" class="external-link"><code>R/bee_calc_baseline.R</code></a></small>
    <div class="hidden name"><code>BEE.calc.baseline.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the daily baseline value using the mean or a quantile of a
timeserie.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">BEE.calc.baseline</span><span class="op">(</span></span>
<span>  <span class="va">yourspatraster</span>,</span>
<span>  start_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">threshold</span>,</span>
<span>  quantile_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time_window <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  smooth_window <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-yourspatraster">yourspatraster<a class="anchor" aria-label="anchor" href="#arg-yourspatraster"></a></dt>
<dd><p>:
The SpatRaster that contains the values to be used to calculate the baseline
(your reference time serie). Each layer must have a date and there must be
<strong>no duplicates</strong>.</p></dd>


<dt id="arg-start-date">start_date<a class="anchor" aria-label="anchor" href="#arg-start-date"></a></dt>
<dd><p>:
The date to use as the first day of your reference period. It must be in the
format <strong>YYYY-MM-DD</strong>. (Note that the provided dataset can cover a longer
time period than the one you want to use as a reference.)</p></dd>


<dt id="arg-end-date">end_date<a class="anchor" aria-label="anchor" href="#arg-end-date"></a></dt>
<dd><p>:
The date to use as the first day of your reference period. It must be in the
format <strong>YYYY-MM-DD</strong>.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>:
Specifies whether you want to use a percentile or the mean of the observed
values as the threshold.
The accepted arguments are <em>"qt"</em>, to specify that you want to compute a
percentile of the observed values in the reference timeframe, or <em>"mean"</em>,
if you want to use the mean of the observed values as threshold.
If you want to use a fixed value as the threshold (e.g. biological optimum),
you can skip this step and use BEE.id.extreme_days() directly.</p></dd>


<dt id="arg-quantile-value">quantile_value<a class="anchor" aria-label="anchor" href="#arg-quantile-value"></a></dt>
<dd><p>:
Indicates the desired percentile value. This must be between 0 and 1.</p></dd>


<dt id="arg-time-window">time_window<a class="anchor" aria-label="anchor" href="#arg-time-window"></a></dt>
<dd><p>:
Number of days on either side of day 'd' that are used to calculate the
threshold value associated for day 'd'.
For example, if <em>"time_window = 5"</em>, the thershold value for 'd' day will
be calculated using data from five days before day d, day d itself,
and the five days after day d, from all years between <em>"start_date"</em> and
<em>"end_date"</em>.</p></dd>


<dt id="arg-smooth-window">smooth_window<a class="anchor" aria-label="anchor" href="#arg-smooth-window"></a></dt>
<dd><p>:
Number of days on either side of day 'd' that are used to calculate the mean
value of the threshold assigned to the 'd' day. This allows your threshold
value to be smoothed across days.
For example, if <em>"smooth_window"</em> is set to 10 days, the final value on
day 'd' will be the mean of the baseline/thershold values calculated for
days: d - 10 to d + 10 (eleven values).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A SpatRaster with one day of the year per layer (366 layers) that has
the same extent, pixel resolution and CRS as the provided SpatRaster. Each
pixel contains the threshold value at which an extreme event is identified
(the baseline value).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Load the example dataset in R environement :</span></span></span>
<span class="r-in"><span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"copernicus_data_celsius.tiff"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  package <span class="op">=</span> <span class="st">"BioExtremeEvent"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">copernicus_data_celsius</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">file_name</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### **90th percentile threshold:** 90 % of the values observed at a given day</span></span></span>
<span class="r-in"><span><span class="co"># accross all years of the reference time period are bellow the baseline</span></span></span>
<span class="r-in"><span><span class="co"># value.</span></span></span>
<span class="r-in"><span><span class="co">#### No smoothing: # 16s to run</span></span></span>
<span class="r-in"><span><span class="va">baseline_qt90_smth_0</span> <span class="op">&lt;-</span> <span class="fu">BEE.calc.baseline</span><span class="op">(</span>yourspatraster <span class="op">=</span> <span class="va">copernicus_data_celsius</span>,</span></span>
<span class="r-in"><span>                                   start_date <span class="op">=</span> <span class="st">"2023-01-01"</span>,</span></span>
<span class="r-in"><span>                                   end_date <span class="op">=</span> <span class="st">"2025-12-31"</span>,</span></span>
<span class="r-in"><span>                                   threshold <span class="op">=</span> <span class="st">"qt"</span>,</span></span>
<span class="r-in"><span>                                   quantile_value <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                                   time_window <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                                   smooth_window <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#### Smoothing over 15 days: # 18s to run</span></span></span>
<span class="r-in"><span><span class="va">baseline_qt90_smth_15</span> <span class="op">&lt;-</span> <span class="fu">BEE.calc.baseline</span><span class="op">(</span>yourspatraster <span class="op">=</span> <span class="va">copernicus_data_celsius</span>,</span></span>
<span class="r-in"><span>                                   start_date <span class="op">=</span> <span class="st">"2023-01-01"</span>,</span></span>
<span class="r-in"><span>                                   end_date <span class="op">=</span> <span class="st">"2025-12-31"</span>,</span></span>
<span class="r-in"><span>                                   threshold <span class="op">=</span> <span class="st">"qt"</span>,</span></span>
<span class="r-in"><span>                                   quantile_value <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                                   time_window <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                                   smooth_window <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="co">#7+1+7=15</span></span></span>
<span class="r-in"><span><span class="co">###**Mean value threshold:**</span></span></span>
<span class="r-in"><span><span class="va">baseline_mean</span> <span class="op">&lt;-</span> <span class="fu">BEE.calc.baseline</span><span class="op">(</span>yourspatraster <span class="op">=</span> <span class="va">copernicus_data_celsius</span>,</span></span>
<span class="r-in"><span>                                   start_date <span class="op">=</span> <span class="st">"2023-01-01"</span>,</span></span>
<span class="r-in"><span>                                   end_date <span class="op">=</span> <span class="st">"2025-12-31"</span>,</span></span>
<span class="r-in"><span>                                   threshold <span class="op">=</span> <span class="st">"mean"</span>,</span></span>
<span class="r-in"><span>                                   time_window <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                                   smooth_window <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#if threshold = "mean", any quantile_value provided will be ignored.</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Victoria Delannoy.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

